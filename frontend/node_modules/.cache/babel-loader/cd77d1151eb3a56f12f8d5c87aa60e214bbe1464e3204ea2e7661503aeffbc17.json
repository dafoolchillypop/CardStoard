{"ast":null,"code":"// src/pages/CardDetail.jsx\nimport React,{useEffect,useState}from\"react\";import{useParams,Link}from\"react-router-dom\";import api from\"../api/api\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function CardDetail(){const{id}=useParams();const[card,setCard]=useState(null);const[settings,setSettings]=useState(null);useEffect(()=>{// Fetch card\napi.get(\"/cards/\".concat(id)).then(res=>setCard(res.data)).catch(err=>console.error(\"Error fetching card:\",err));// Fetch settings (for market factor/value calc)\napi.get(\"/settings/\").then(res=>setSettings(res.data)).catch(err=>console.error(\"Error fetching settings:\",err));},[id]);if(!card)return/*#__PURE__*/_jsx(\"p\",{children:\"Loading card...\"});// ✅ Rookie check\nconst isRookie=card.rookie===\"*\"||card.rookie===\"1\"||Number(card.rookie)===1||card.rookie===true;// ✅ Grade badge\nconst g=parseFloat(card.grade);let gradeClass=\"grade-unknown\";if(!Number.isNaN(g)){if(g===3)gradeClass=\"grade-mt\";else if(g===1.5)gradeClass=\"grade-ex\";else if(g===1)gradeClass=\"grade-vg\";else if(g===0.8)gradeClass=\"grade-gd\";else if(g===0.4)gradeClass=\"grade-fr\";else gradeClass=\"grade-pr\";}// ✅ Market factor + card value calc\nlet cardValue=null;if(settings){const books=[parseFloat(card.book_high)||0,parseFloat(card.book_high_mid)||0,parseFloat(card.book_mid)||0,parseFloat(card.book_low_mid)||0,parseFloat(card.book_low)||0];const avgBook=books.reduce((a,b)=>a+b,0)/books.length;let factor=null;if(g===3&&isRookie)factor=settings.auto_factor;else if(g===3)factor=settings.mtgrade_factor;else if(isRookie)factor=settings.rookie_factor;else if(g===1.5)factor=settings.exgrade_factor;else if(g===1)factor=settings.vggrade_factor;else if(g===0.8)factor=settings.gdgrade_factor;else if(g===0.4)factor=settings.frgrade_factor;else if(g===0.2)factor=settings.prgrade_factor;if(factor!==null){cardValue=Math.round(avgBook*g*factor);}}let valueClass=\"value-low\";if(cardValue!==null){if(cardValue>=500)valueClass=\"value-high\";else if(cardValue>=200)valueClass=\"value-mid\";else if(cardValue>=50)valueClass=\"value-lowmid\";}return/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:\"center\"},children:[/*#__PURE__*/_jsxs(\"h2\",{children:[card.year,\" \",card.brand,\" \",card.first_name,\" \",card.last_name,\" #\",card.card_number,isRookie&&/*#__PURE__*/_jsx(\"span\",{style:{marginLeft:\"0.5rem\",color:\"gold\",fontSize:\"1.5rem\"},children:\"\\u2B50 (RC)\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{margin:\"0.5rem 0\"},children:[card.grade&&/*#__PURE__*/_jsxs(\"span\",{className:\"badge badge-grade \".concat(gradeClass),children:[\"Grade: \",card.grade]}),cardValue!==null&&/*#__PURE__*/_jsxs(\"span\",{className:\"badge badge-value \".concat(valueClass),children:[\"Value: $\",cardValue]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",justifyContent:\"center\",gap:\"2rem\",marginTop:\"1rem\"},children:[card.front_image&&/*#__PURE__*/_jsx(\"img\",{src:\"http://host.docker.internal:8000\".concat(card.front_image),alt:\"Front\",style:{maxWidth:\"800px\",height:\"auto\"}}),card.back_image&&/*#__PURE__*/_jsx(\"img\",{src:\"http://host.docker.internal:8000\".concat(card.back_image),alt:\"Back\",style:{maxWidth:\"800px\",height:\"auto\"}})]}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:\"1rem\"},children:/*#__PURE__*/_jsx(Link,{to:\"/list-cards\",className:\"nav-btn\",children:\"\\u2B05 Back to List\"})})]});}","map":{"version":3,"names":["React","useEffect","useState","useParams","Link","api","jsx","_jsx","jsxs","_jsxs","CardDetail","id","card","setCard","settings","setSettings","get","concat","then","res","data","catch","err","console","error","children","isRookie","rookie","Number","g","parseFloat","grade","gradeClass","isNaN","cardValue","books","book_high","book_high_mid","book_mid","book_low_mid","book_low","avgBook","reduce","a","b","length","factor","auto_factor","mtgrade_factor","rookie_factor","exgrade_factor","vggrade_factor","gdgrade_factor","frgrade_factor","prgrade_factor","Math","round","valueClass","style","textAlign","year","brand","first_name","last_name","card_number","marginLeft","color","fontSize","margin","className","display","justifyContent","gap","marginTop","front_image","src","alt","maxWidth","height","back_image","to"],"sources":["/home/shawn/projects/CardStoard/frontend/src/pages/CardDetail.jsx"],"sourcesContent":["// src/pages/CardDetail.jsx\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { useParams, Link } from \"react-router-dom\";\r\nimport api from \"../api/api\";\r\n\r\nexport default function CardDetail() {\r\n  const { id } = useParams();\r\n  const [card, setCard] = useState(null);\r\n  const [settings, setSettings] = useState(null);\r\n\r\n  useEffect(() => {\r\n    // Fetch card\r\n    api.get(`/cards/${id}`)\r\n      .then((res) => setCard(res.data))\r\n      .catch((err) => console.error(\"Error fetching card:\", err));\r\n\r\n    // Fetch settings (for market factor/value calc)\r\n    api.get(\"/settings/\")\r\n      .then((res) => setSettings(res.data))\r\n      .catch((err) => console.error(\"Error fetching settings:\", err));\r\n  }, [id]);\r\n\r\n  if (!card) return <p>Loading card...</p>;\r\n\r\n  // ✅ Rookie check\r\n  const isRookie =\r\n    card.rookie === \"*\" || card.rookie === \"1\" || Number(card.rookie) === 1 || card.rookie === true;\r\n\r\n  // ✅ Grade badge\r\n  const g = parseFloat(card.grade);\r\n  let gradeClass = \"grade-unknown\";\r\n  if (!Number.isNaN(g)) {\r\n    if (g === 3) gradeClass = \"grade-mt\";\r\n    else if (g === 1.5) gradeClass = \"grade-ex\";\r\n    else if (g === 1) gradeClass = \"grade-vg\";\r\n    else if (g === 0.8) gradeClass = \"grade-gd\";\r\n    else if (g === 0.4) gradeClass = \"grade-fr\";\r\n    else gradeClass = \"grade-pr\";\r\n  }\r\n\r\n  // ✅ Market factor + card value calc\r\n  let cardValue = null;\r\n  if (settings) {\r\n    const books = [\r\n      parseFloat(card.book_high) || 0,\r\n      parseFloat(card.book_high_mid) || 0,\r\n      parseFloat(card.book_mid) || 0,\r\n      parseFloat(card.book_low_mid) || 0,\r\n      parseFloat(card.book_low) || 0,\r\n    ];\r\n    const avgBook = books.reduce((a, b) => a + b, 0) / books.length;\r\n    let factor = null;\r\n\r\n    if (g === 3 && isRookie) factor = settings.auto_factor;\r\n    else if (g === 3) factor = settings.mtgrade_factor;\r\n    else if (isRookie) factor = settings.rookie_factor;\r\n    else if (g === 1.5) factor = settings.exgrade_factor;\r\n    else if (g === 1) factor = settings.vggrade_factor;\r\n    else if (g === 0.8) factor = settings.gdgrade_factor;\r\n    else if (g === 0.4) factor = settings.frgrade_factor;\r\n    else if (g === 0.2) factor = settings.prgrade_factor;\r\n\r\n    if (factor !== null) {\r\n      cardValue = Math.round(avgBook * g * factor);\r\n    }\r\n  }\r\n\r\n  let valueClass = \"value-low\";\r\n  if (cardValue !== null) {\r\n    if (cardValue >= 500) valueClass = \"value-high\";\r\n    else if (cardValue >= 200) valueClass = \"value-mid\";\r\n    else if (cardValue >= 50) valueClass = \"value-lowmid\";\r\n  }\r\n\r\n  return (\r\n    <div style={{ textAlign: \"center\" }}>\r\n      {/* Heading with Rookie Star */}\r\n      <h2>\r\n        {card.year} {card.brand} {card.first_name} {card.last_name} #{card.card_number}\r\n        {isRookie && (\r\n          <span style={{ marginLeft: \"0.5rem\", color: \"gold\", fontSize: \"1.5rem\" }}>⭐ (RC)</span>\r\n        )}\r\n      </h2>\r\n\r\n      {/* Grade Badge */}\r\n      <div style={{ margin: \"0.5rem 0\" }}>\r\n        {card.grade && (\r\n          <span className={`badge badge-grade ${gradeClass}`}>\r\n            Grade: {card.grade}\r\n          </span>\r\n        )}\r\n      \r\n      {/* Card Value Badge */}\r\n        {cardValue !== null && (\r\n          <span className={`badge badge-value ${valueClass}`}>\r\n            Value: ${cardValue}\r\n          </span>\r\n        )}\r\n      </div>\r\n\r\n      {/* Images */}\r\n      <div\r\n        style={{\r\n          display: \"flex\",\r\n          justifyContent: \"center\",\r\n          gap: \"2rem\",\r\n          marginTop: \"1rem\",\r\n        }}\r\n      >\r\n      {card.front_image && (\r\n        <img\r\n          src={`http://host.docker.internal:8000${card.front_image}`}\r\n          alt=\"Front\"\r\n          style={{\r\n            maxWidth: \"800px\",\r\n            height: \"auto\",\r\n          }}\r\n        />\r\n      )}\r\n      {card.back_image && (\r\n        <img\r\n          src={`http://host.docker.internal:8000${card.back_image}`}\r\n          alt=\"Back\"\r\n          style={{\r\n            maxWidth: \"800px\",\r\n            height: \"auto\",\r\n          }}\r\n        />\r\n      )}\r\n      </div>\r\n\r\n      {/* Back link */}\r\n      <div style={{ marginTop: \"1rem\" }}>\r\n        <Link to=\"/list-cards\" className=\"nav-btn\">⬅ Back to List</Link>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}